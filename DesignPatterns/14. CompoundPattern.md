# 복합 패턴(Compound Pattern)

## 1. 패턴 이름과 종류
- 이름: 복합 패턴(Compound Pattern)
- 종류: 여러 패턴의 조합

---

## 2. 용도(Intent)
여러 디자인 패턴을 **의도적으로 섞어서** 더 강력한 설계 해결책을 만드는 것.  
헤드퍼스트에서는 특히 **MVC(Model-View-Controller)** 구조를 복합 패턴의 대표 예로 설명합니다.

---

## 3. 동기(Motivation)
오리 시뮬레이터, MVC, 복잡한 UI 시스템 등에서는  
하나의 패턴만으로는 요구사항을 만족시키기 힘듭니다.  
예를 들어 MVC에서는:  
- 모델: **옵저버 패턴**  
- 뷰: 옵저버/전략  
- 컨트롤러: **전략 패턴**  
등을 조합하여 사용합니다.

---

## 4. 적용 대상(Applicability)
- 복잡한 시스템에서 여러 관심사가 얽혀 있을 때  
- 단일 패턴으로 해결이 어렵고, 여러 패턴을 조합해야 할 때  
- MVC, MVP, MVVM 같은 아키텍처 수준 설계를 할 때

---

## 5. 구조(Structure – MVC 예)

```

+-----------+          +-----------+
|   View    |<-------->|Controller |
+-----------+   사용자 |-----------|
| (Observer)|  입력/이벤트       |
+-----------+          |
       ^               |
       | observes      |
       |               v
+-----------+    notifies(Observer)
|   Model   |----------------------+
+-----------+                      |
| (Subject) |<---------------------+
+-----------+

- Model: Observer 패턴의 Subject, 상태를 가지고 변경 시 View 들에게 알림
- View: Observer, Model 을 구독하고 렌더링
- Controller: Strategy 처럼, 입력을 받아 Model/ View 를 제어
(옵저버 + 전략 + 때로는 상태/커맨드 등이 함께 섞이는 복합 패턴)

```

---

## 6. 구성 요소(Participants - MVC 기준)
- **Model**  
  - 애플리케이션 핵심 데이터/로직  
  - 옵저버 패턴의 Subject 역할  
- **View**  
  - Model의 상태를 시각적으로 표현  
  - 옵저버(Observer) 역할  
- **Controller**  
  - 사용자 입력을 받아 Model, View를 조작  
  - 전략 패턴의 ConcreteStrategy와 비슷한 역할을 수행

---

## 7. 협동(Collaborations)
- View는 Model을 옵저버로서 구독하고, Model 상태 변경 시 자동 갱신  
- Controller는 사용자의 액션을 받아 Model을 변경하고 View를 업데이트  
- 전체적으로 패턴들의 협동으로 UI/비즈니스 로직 분리가 강화됨

---

## 8. 결과(Consequences)
### 장점
- 관심사 분리(Cross-cutting concerns 분리)  
- 유지보수하기 좋은 아키텍처  
- 각각의 역할을 테스트하기 쉬움

### 단점
- 설계가 복잡해짐  
- 작은 프로젝트에서는 과할 수 있음

---

## 9. 구현(Implementation)
- Model은 옵저버(Observer) 인터페이스를 통해 View에게 알림  
- Controller는 View와 Model 모두에 대한 참조를 가질 수 있음  
- 패턴 조합 시 각 패턴의 의도와 책임이 섞이지 않도록 주의

---

## 10. 샘플 코드(아주 단순 MVC 스케치)

```java
// Model (Subject)
public interface BeatModel {
    void registerObserver(BeatObserver o);
    void removeObserver(BeatObserver o);
    int getBPM();
}

// View (Observer)
public class DJView implements BeatObserver {
    private BeatModel model;

    public DJView(BeatModel model) {
        this.model = model;
        model.registerObserver(this);
    }

    public void updateBeat() {
        // 화면 갱신
    }
}

// Controller
public class BeatController {
    private BeatModel model;

    public BeatController(BeatModel model) {
        this.model = model;
    }

    public void increaseBPM() {
        // model.setBPM(model.getBPM() + 1);
    }
}
```

## 11. 사용 예(Known Uses)
- MVC 기반 웹 프레임워크 (Spring MVC, Rails 등)
- Android의 MVVM(Mediator, Observer 등 패턴 조합)
- 복잡한 게임 엔진 구조

## 12. 연관 패턴(Related Patterns)
- 옵저버, 전략, 컴포지트, 상태, 커맨드 등
- 아키텍처 패턴(MVC, MVP, MVVM)은 대부분 복합 패턴의 한 예로 볼 수 있음
