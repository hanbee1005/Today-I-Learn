# Kafka 개념 및 용어 정리
## Kafka란?
Kafka란 파이프라인, 스트리밍 분석, 데이터 통합 및 미션 크리티컬 애플리케이션을 위해 설계된 고성능 분산 이벤트 스트리밍 플랫폼입니다. 카프카는 링크드인(Linked-In)에서 개발했습니다.             

카프카를 적용함으로써
- 모든 이벤트/데이터의 흐름을 중앙에서 관리할 수 있게 되었고
- 새로운 서비스/시스템이 추가되어도 카프카가 제공하는 표준 포맷으로 연결하면 되므로 확장성과 신뢰성이 증가하였습니다.
- 또한 개발자는 각 서비스 간의 연결이 아닌 서비스들의 비즈니스 로직에 집중이 가능하게 되었습니다.

## 주요 용어
### Zookeeper
분산 애플리케이션 관리를 위한 코디네이터 시스템입니다. 분산되어 있는 각 애플리케이션의 정보를 중앙에 집중하고 구성 관리, 그룹 관리 네이밍, 동기화 등의 서비스를 제공합니다.

### Broker
실행된 카프카 서버를 의미합니다. producer와 consumer는 별도의 애플리케이션으로 구성되는 반면, broker는 카프카 자체를 의미합니다. Broker(각 서버)는 Kafka Cluster 내부에 하나 이상 존재합니다. 각 서버 내부에 메시지를 저장하고 관리하는 역할을 수행합니다.

### Partition
토픽을 분할하는 단위로 하나의 토픽은 여러개의 파티션을 가질 수 있습니다. 파티션의 개수는 변경이 가능한데 추가만 가능하고 삭제는 불가합니다. (토픽 자체를 지워야 전체 파티션이 삭제)                       
파티션이 하나라면 순서 보장이 가능합니다. 파티션 내부에서 각 메시지는 offset(고유번호)로 구분이 됩니다.                            
파티션이 여러개라면 Kafka 클러스터가 라운드 로빈 방식(default)으로 분배해서 분산처리되기 때문에 순서 보장을 할 수 없습니다. 파티션이 많을수록 처리량이 좋지만 장애 복구 시간이 늘어납니다.

### Topic
파티션의 모음이라고 할 수 있습니다. 각각의 메시지를 목적에 맞게 구분할 때 사용합니다. 메시지를 전송하거나 소비할 때 Topic을 반드시 입력합니다. 즉, Topic 단위로 producer가 메시지가 전송하고 consumer는 자신이 담당하는 메시지를 처리하게 됩니다.

### Producer
메시지를 만들어 카프카 클러스터에 전송하는 주체입니다. 메시지 전송 시 Batch 처리가 가능합니다. key 값을 지정하여 특정 파티션으로만 전송하는 것도 가능합니다.                     
전송 ACKS 값을 설정하여 효율성을 높일 수 있습니다.                      
- ACKS=0 : 매우 빠르게 전송하며 파티션 리더가 받았는지 아닌지 알 수 없습니다.
- ACKS=1 : 파티션 리더가 받았는지 확인하는 방식으로 default 입니다.
- ACKS=ALL : 파티션 리더 뿐만 아니라 팔로워까지 메시지를 받았는지 확인하는 방식입니다.

### Consumer
카프카 클러스터에서 메시지를 읽어서 처리하는 주체입니다. 메시지를 Batch로 처리할 수 있습니다. 한개의 consumer는 여러개의 topic을 처리할 수 있습니다.                                   
consumer는 consumer group에 속하게 됩니다. 한개의 파티션은 consumer group 내 하나의 consumer에게만 연결이 됩니다. 따라서 consumer group 내 consumer 들은 동일한 토픽을 구독하고 있는 것이 일반적이고 하나의 토픽에 대해 하나의 consumer group에서 구독하는 consumer의 개수는 토픽의 파티션 개수와 맞추는 것이 좋습니다.

## 정리
- [개인 블로그글](https://developerbee.tistory.com/259)
