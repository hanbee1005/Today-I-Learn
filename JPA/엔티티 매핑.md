# 엔티티 매핑
- 객체와 테이블 매핑 `@Entity`, `@Table`
    - `@Entity`
        - JPA가 관리, 엔티티라고 한다.
        - JPA를 사용해서 테이블과 매핑할 클래스는 `@Entity` 필수
        - 주의!
            - **기본 생성자 필수**! (파라미터가 없는 public 또는 protected 생성자)
            - final 클래스, enum, interface, inner 클래스 사용 x
            - 저장할 필드에 final 사용 x
        - 속성
            - name - JPA 에서 사용할 엔티티 이름을 지정하는데 기본값은 클래스 이름
    - `@Table`
        - 엔티티와 매핑할 테이블 지정
        - 속성
            - name - 매핑할 테이블 이름으로 기본값은 엔티티 이름을 그대로 사용
            - catalog -  데이터베이스 catalog 매핑
            - schema - 데이터베이스 schema 매핑
            - uniqueConstraints(DDL) - DDL 생성 시에 유니크 제약 조건 생성
- 데이터베이스 스키마 자동 생성
    - DDL을 애플리케이션 실행 시점에 자동 생성
    - 테이블 중심 → 객체 중심
    - 데이터베이스 방언을 활용해서 데이터베이스에 맞는 적절한 DDL 생성 → 이렇게 생성된 DDL은 개발 장비에서만 사용, 운영 서버에서는 사용하지 않거나 다듬어서 사용해야 함!!!
    - `hibernate.hbm2ddl.auto` 속성
        - create : 기존 테이블을 삭제 후 다시 생성 (DROP + CREATE) **- 운영에서 절대 x, 개발 초기**
        - create-drop : create와 같으나 종료 시점에 테이블 DROP **- 운영에서 절대 x, 개발 초기**
        - update :  변경 분만 반영, 추가만 적용됨 **- 운영에서 절대 x, 개발 초기 or 테스트 서버**
        - validate : 엔티티와 테이블이 정상 매핑되었는지만 확인 - 테스트 서버 or 스테이지, 운영 서버
        - none : 사용하지 않음 - 스테이지, 운영 서버
    - DDL 생성 기능 - 제약 조건 추가
        - `@Column(unique = true, length = 10)`
        - JPA 실행에는 영향을 주지 x
- 필드와 컬럼 매핑 `@Column`
    - `@Id` - PK 매핑
    - `@Column(name = “컬럼명”)`
        - name : 필드와 매핑할 테이블의 컬럼 이름으로 기본값은 필드 이름
        - insertable, updatable : 등록, 변경 가능 여부로 기본값은 true
        - nullable (DDL) : null 값의 허용 여부를 설정, false로 하면 DDL 생성 시 not null 제약 조건 추가
        - unique (DDL) : `@Table`의 uniqueConstraint와 같지만 한 컬럼에 간단히 유니크 제약 조건을 추가할 때 사용
        - columnDefinition (DDL) : 데이터베이스 컬럼 정보를 직접 줄 수 있다.
        - length (DDL) : 문자 길이 제약 조건, String 타입에만 사용
        - precision, scale (DDL) : BigDecimal 타입에서 사용, precision은 소수점을 포함한 전체 자릿수, scale은 소수의 자릿수이다.
    - `@Enumerated(EnumType.STRING)` - Enum 타입을 쓰고 싶을 때 사용
        - ORDINAL -  Enum 순서를 저장 (default)
        - STRING - Enum 이름을 저장
    - `@Temporal(TemporalType.TIMESTAMP)` - 날짜 타입을 사용할 때 (DATE, TIME, TIMESTAMP)
        - LocalDate, LocalDateTime에서는 생략 가능
    - `@Lob` - CLOB, BLOB 사용하고자 할 때
        - 문자면 CLOB, 나머지는 BLOB 매핑
    - `@Transient` - 특정 필드를 컬럼으로 만들고 싶지 않을 때
- 기본 키 매핑 `@Id`
    - 직접 할당 : `@Id` 만 사용
    - 자동 생성 : `@GeneratedValue`
        - IDENTITY : 데이터베이스에 위임, MySQL
            - 주로 MySQL, PostgreSQL, SQL Server, DB2에서 사용
            - JPA는 보통 트랜잭션 커밋 시점에 INSERT SQL을 실행하지만 AUTO_INCREMENT는 데이터베이스에 INSERT SQL을 실행한 이후에 ID 값을 알 수 있기 때문에 `em.persist()` 시점에 즉시 INSERT SQL을 실행하고 DB에서 식별자를 조회
        - SEQUENCE : 데이터베이스 시퀀스 오브젝트 사용, ORACLE
            - 데이터베이스 시퀀스는 유일한 값을 순서대로 생성하는 특별한 데이터베이스 오브젝트
            - 오라클, PostgreSQL, BD2, H2 데이터베이스에서 사용
            - @SequenceGenerator 필요
        - TABLE : 키 생성용 테이블 사용, 모든 DB에서 사용
            - 키 생성 전용 테이블을 하나 만들어서 데이터베이스 시퀀스를 흉내내는 전략
            - 장점: 모든 DB에서 사용 가능 /  단점: 성능
            - @TableGenerator 필요
        - AUTO : 방언에 따라 자동 지정, 기본값